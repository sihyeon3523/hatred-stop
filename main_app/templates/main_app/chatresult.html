{% load static %}
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="generator" content="Mobirise v5.6.8, mobirise.com">
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image:src" content="">
    <meta property="og:image" content="">
    <meta name="twitter:title" content="Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <link rel="shortcut icon" href="{% static 'main_app/assets/images/logo.png' %}" type="image/x-icon">
    <meta name="description" content="">

    <title>Sentiment-analysis</title>

    {% block scripts %}
    <script>

    if ({{result}} == 1){

      // giphy 사용
      let APIKEY = "5Tt13Kfb6gp4Q6NvMye6zrEK00ey3yBH";
      document.addEventListener("DOMContentLoaded", init);

      function init() {
        addtext = "<div style='margin:20px 10px;text-align:right;'> <span style='padding:5px 10px;background-color:#f9e000;border-radius:3px;'>삐빅! {{result_prob}}%로 혐오문장입니다</span></div>";
        document.getElementById("chatbox").innerHTML += addtext;

        var mydiv = document.getElementById("chatbox");
        mydiv.scrollTop = document.getElementById("chatbox").scrollHeight;

        let url = `https://api.giphy.com/v1/gifs/search?api_key=${APIKEY}&limit=1&q=`;
        let str = 'nope';
        url = url.concat(str);
        console.log(url);
        let count = 0;
        fetch(url)
          .then(response => response.json())
          .then(content => {
              //  data, pagination, meta
              console.log(content.data);
              console.log("META", content.meta);

              // giphy에서 분석된 감정을 검색한 결과 움짤을 가져와 figure 태그 안에 img 태그 추가
              let fig = document.createElement("figure");
              fig.style="text-align:right;";
              let img = document.createElement("img");
              img.src = content.data[0].images.downsized.url;
              img.alt = content.data[0].title;
              fig.appendChild(img);
              let out = document.querySelector(".out"); // class명이 out인 태그 찾기
              out.insertAdjacentElement("afterbegin", fig); // 그 안에 생성한 figure 태그 추가
            })
            .catch(err => {
              console.error(err);
            });
        };

      }else{
        // giphy 사용
        let APIKEY = "5Tt13Kfb6gp4Q6NvMye6zrEK00ey3yBH";
        document.addEventListener("DOMContentLoaded", init);

        function init() {
          addtext = "<div style='margin:20px 10px;text-align:right;'> <span style='padding:5px 10px;background-color:#f9e000;border-radius:3px;'>{{result_prob}}% 로 클린한 문장입니다.</span></div>";
          document.getElementById("chatbox").innerHTML += addtext;

          var mydiv = document.getElementById("chatbox");
          mydiv.scrollTop = document.getElementById("chatbox").scrollHeight;

          let url = `https://api.giphy.com/v1/gifs/search?api_key=${APIKEY}&limit=1&q=`;
          let str = 'good';
          url = url.concat(str);
          console.log(url);
          let count = 0;
          fetch(url)
            .then(response => response.json())
            .then(content => {
                //  data, pagination, meta
                console.log(content.data);
                console.log("META", content.meta);

                // giphy에서 분석된 감정을 검색한 결과 움짤을 가져와 figure 태그 안에 img 태그 추가
                let fig = document.createElement("figure");
                fig.style="text-align:right;";
                let img = document.createElement("img");
                img.src = content.data[0].images.downsized.url;
                img.alt = content.data[0].title;
                fig.appendChild(img);
                let out = document.querySelector(".out"); // class명이 out인 태그 찾기
                out.insertAdjacentElement("afterbegin", fig); // 그 안에 생성한 figure 태그 추가
              })
              .catch(err => {
                console.error(err);
              });
          };

      };


      </script>
    {% endblock %}
    {% block styles %}
    <style>
    .button {
      background-color: #40b0bf;
      border: none;
      color: white;
      padding: 10px 0;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      font-weight: bold;
      margin: 4px 2px;
      transition-duration: 0.4s;
      cursor: pointer;
      width:100%
    }

    .button1 {
      background-color: #40b0bf;
      color: white;
      border: 2px solid #ffffff;
    }

    .button1:hover {
      background-color: white;
      color: #40b0bf;
    }
    </style>
    {% endblock %}

    <link rel="stylesheet" href="{% static 'main_app/assets/bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'main_app/assets/bootstrap/css/bootstrap-grid.min.css' %}">
    <link rel="stylesheet" href="{% static 'main_app/assets/bootstrap/css/bootstrap-reboot.min.css' %}">
    <link rel="stylesheet" href="{% static 'main_app/assets/dropdown/css/style.css' %}">
    <link rel="stylesheet" href="{% static 'main_app/assets/socicon/css/styles.css' %}">
    <link rel="stylesheet" href="{% static 'main_app/assets/theme/css/style.css' %}">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,400;0,700;1,400;1,700&display=swap&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,400;0,700;1,400;1,700&display=swap&display=swap"></noscript>
    <link rel="preload" as="style" href="{% static 'main_app/assets/mobirise/css/mbr-additional.css' %}">
    <link rel="stylesheet" href="{% static 'main_app/assets/mobirise/css/mbr-additional.css' %}" type="text/css">

  </head>

  <body style="height:100%;background-color:#BBCCDD">
    <section data-bs-version="5.1" class="menu menu1 cid-t7BXZ5znui" once="menu" id="menu1-0">

      <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
          <div class="container">
              <div class="navbar-brand">

                  <span class="navbar-caption-wrap"><a class="navbar-caption text-black display-7" href="{% url 'main_app:index' %}">👼혐오멈춰✋</a></span>
              </div>
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                  <div class="hamburger">
                      <span></span>
                      <span></span>
                      <span></span>
                      <span></span>
                  </div>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true">
                    <li class="nav-item"><a class="nav-link link text-black display-4" href="{% url 'main_app:aboutus' %}">
                      <strong>팀원소개</strong></a>
                    </li>
                    <li class="nav-item"><a class="nav-link link text-black display-4" href="{% url 'main_app:chathome' %}">
                      <strong>서비스</strong></a>
                    </li>
                  </ul>

              </div>
          </div>
      </nav>
    </section>

<section>
  <div class="container">
    <div class="col-12" style="margin-top:20px;">
      <h3><strong>My Chat</strong></h3>
    </div>

    <div style="height:600px;background-color:#BBCCDD" id="chatbox">...
        <div style='margin:20px 10px;text-align:right;'>
          <span style='padding:5px 10px;background-color:#f9e000;border-radius:3px;'>{{target_sentence}}</span>
        </div>
        <div  class="out" style='margin:0 10px 0px 65%;text-align:right;'>
        </div>
    </div>

    <div class="chatfooter">

        <table width="100%">
          <tr>
            <td width="85%"align="left">
              <input type="text"  name="target_sentence" id="chattext" style="padding:10px 0;width:100%;border:solid 1px #40b0bf;">
            </td>
            <td width="15%"align="right">
              <button class="button button1" onclick="location.href={% url 'main_app:chathome' %} ">RETRY</button>
            </td>
          </tr>
        </table>

    </div>

  </div>
</section>

<section data-bs-version="5.1" class="footer7 cid-t7BYb1Uixm" once="footers" id="footer7-1">

    <div class="container">
        <div class="media-container-row align-center mbr-white">
            <div class="col-12">
                <p class="mbr-text mb-0 mbr-fonts-style display-7">멋쟁이사자처럼 K-Digital Training AI SCHOOL 5기_ 👼혐오 멈춰✋</p>
            </div>
        </div>
    </div>
</section>

<section class="display-7" style="padding: 0;align-items: center;justify-content: center;flex-wrap: wrap;    align-content: center;display: flex;position: relative;height: 4rem;">

    <a href="https://mobiri.se/2774020" style="flex: 1 1;height: 4rem;position: absolute;width: 100%;z-index: 1;">
        <img alt="" style="height: 4rem;" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==">
    </a>
        <p style="margin: 0;text-align: center;" class="display-7">Built with Mobirise &#8204;</p>
        <a style="z-index:1" href="https://mobirise.com/website-maker.html">Website Maker</a>
</section>

    <script src="{% static 'main_app/assets/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'main_app/assets/smoothscroll/smooth-scroll.js' %}"></script>
    <script src="{% static 'main_app/assets/ytplayer/index.js' %}"></script>
    <script src="{% static 'main_app/assets/dropdown/js/navbar-dropdown.js' %}"></script>
    <script src="{% static 'main_app/assets/theme/js/script.js' %}"></script>

</body>

</html>
